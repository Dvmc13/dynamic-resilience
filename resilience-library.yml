resilience:
  monitor:
    interval: 30s  # Intervalo de monitoreo de mÃ©tricas

  services:
    - name: catalog-service
      host: localhost
      port: 8081
      metrics:
        latencyEndpoint: /actuator/prometheus?name=http_server_requests_seconds_sum
        errorEndpoint: /actuator/prometheus?name=http_server_requests_seconds_count

    - name: order-service
      host: localhost
      port: 8082
      metrics:
        latencyEndpoint: /actuator/prometheus?name=http_server_requests_seconds_sum
        errorEndpoint: /actuator/prometheus?name=http_server_requests_seconds_count

  rules:
    - service: catalog-service
      condition: "latency > 500"
      action: "circuitBreaker.open()"

    - service: catalog-service
      condition: "latency < 200"
      action: "retry.maxAttempts = 3"

    - service: order-service
      condition: "errorRate > 0.20"
      action: "circuitBreaker.open()"

    - service: order-service
      condition: "errorRate < 0.10"
      action: "circuitBreaker.close()"
